# Seleniumè‡ªå‹•åŒ–å®Œå…¨ã‚¬ã‚¤ãƒ‰ - ãƒ­ã‚°æ©Ÿèƒ½ã¨ãƒ‡ãƒãƒƒã‚°å¼·åŒ–ç‰ˆ

ç´ æ™´ã‚‰ã—ã„æ”¹å–„ææ¡ˆã‚’ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™! ä»Šå›ã¯ã€å…¥åŠ›ç¢ºèªã€ãƒ­ã‚°æ©Ÿèƒ½ã€å†è©¦è¡Œæ©Ÿèƒ½ã‚’è¿½åŠ ã—ãŸæœ€å¼·ç‰ˆã®é–¢æ•°ç¾¤ã‚’ä½œæˆã—ã¾ã™!

## æœ€å¼·ç‰ˆ: ãƒ­ã‚°ãƒ»å†è©¦è¡Œãƒ»å…¥åŠ›ç¢ºèªä»˜ãå®Œå…¨ç‰ˆ

```python
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.common.exceptions import (
    NoSuchElementException,
    ElementNotInteractableException,
    TimeoutException,
    WebDriverException
)
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import logging
import os
import time
from datetime import datetime

# ==================== ãƒ­ã‚°è¨­å®š ====================

def setup_logging(log_file="selenium_automation.log", level=logging.INFO):
    """
    ãƒ­ã‚°è¨­å®šã‚’åˆæœŸåŒ–ã™ã‚‹é–¢æ•°
    
    Args:
        log_file (str): ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
        level: ãƒ­ã‚°ãƒ¬ãƒ™ãƒ« (INFO, DEBUG, WARNING, ERROR)
    """
    # ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ
    log_dir = os.path.dirname(log_file)
    if log_dir and not os.path.exists(log_dir):
        os.makedirs(log_dir)
    
    # ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
    log_format = '%(asctime)s - %(levelname)s - [%(funcName)s] %(message)s'
    date_format = '%Y-%m-%d %H:%M:%S'
    
    # ãƒ­ã‚®ãƒ³ã‚°è¨­å®š
    logging.basicConfig(
        level=level,
        format=log_format,
        datefmt=date_format,
        handlers=[
            logging.FileHandler(log_file, encoding='utf-8'),
            logging.StreamHandler()
        ]
    )
    
    logging.info("="*60)
    logging.info("Seleniumè‡ªå‹•åŒ–ãƒ­ã‚°é–‹å§‹")
    logging.info("="*60)


# ==================== å…¥åŠ›ç¢ºèªä»˜ãé–¢æ•° ====================

def input_text_by_xpath(driver, xpath, text, timeout=10, verify=True):
    """
    XPathã‚’æŒ‡å®šã—ã¦ãƒ•ã‚©ãƒ¼ãƒ ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã™ã‚‹é–¢æ•°ï¼ˆå…¥åŠ›ç¢ºèªä»˜ãï¼‰
    
    Args:
        driver (WebDriver): WebDriverã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        xpath (str): å…¥åŠ›å¯¾è±¡ã®ãƒ•ã‚©ãƒ¼ãƒ ã®XPath
        text (str): å…¥åŠ›ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ
        timeout (int): å¾…æ©Ÿæ™‚é–“ï¼ˆç§’ï¼‰
        verify (bool): å…¥åŠ›å†…å®¹ã‚’ç¢ºèªã™ã‚‹ã‹
    """
    try:
        logging.info(f"XPath '{xpath}' ã¸ã®å…¥åŠ›ã‚’é–‹å§‹ã—ã¾ã™...")
        
        # è¦ç´ ãŒå…¥åŠ›å¯èƒ½ã«ãªã‚‹ã¾ã§å¾…æ©Ÿ
        form = WebDriverWait(driver, timeout).until(
            EC.element_to_be_clickable((By.XPATH, xpath))
        )
        
        # å…¥åŠ›å‡¦ç†
        form.clear()
        form.send_keys(text)
        
        # å…¥åŠ›ç¢ºèª
        if verify:
            actual_value = form.get_attribute('value')
            if actual_value == text:
                logging.info(f"âœ… XPath '{xpath}' ã« '{text}' ã‚’æ­£ã—ãå…¥åŠ›ã—ã¾ã—ãŸ")
            else:
                logging.warning(f"âš ï¸ XPath '{xpath}' ã«å…¥åŠ›ãŒæ­£ã—ãåæ˜ ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ")
                logging.warning(f"æœŸå¾…å€¤: '{text}', å®Ÿéš›: '{actual_value}'")
        else:
            logging.info(f"XPath '{xpath}' ã« '{text}' ã‚’å…¥åŠ›ã—ã¾ã—ãŸ")
            
    except TimeoutException:
        logging.error(f"âŒ ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: XPath '{xpath}' ã®è¦ç´ ãŒ{timeout}ç§’ä»¥å†…ã«æº–å‚™ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ")
    except NoSuchElementException:
        logging.error(f"âŒ è¦ç´ æœªæ¤œå‡º: XPath '{xpath}' ã®è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ")
    except ElementNotInteractableException:
        logging.error(f"âŒ æ“ä½œä¸èƒ½: XPath '{xpath}' ã®è¦ç´ ãŒéè¡¨ç¤ºã¾ãŸã¯ç„¡åŠ¹ã§ã™")
    except WebDriverException as e:
        logging.error(f"âŒ WebDriverã‚¨ãƒ©ãƒ¼: {e}")
    except Exception as e:
        logging.error(f"âŒ äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼: {e}")


def input_text_by_css(driver, css_selector, text, timeout=10, verify=True, log_level=logging.INFO):
    """
    CSSã‚»ãƒ¬ã‚¯ã‚¿ã‚’æŒ‡å®šã—ã¦ãƒ•ã‚©ãƒ¼ãƒ ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã™ã‚‹é–¢æ•°ï¼ˆå…¥åŠ›ç¢ºèªä»˜ãï¼‰
    
    Args:
        driver (WebDriver): WebDriverã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        css_selector (str): å…¥åŠ›å¯¾è±¡ã®ãƒ•ã‚©ãƒ¼ãƒ ã®CSSã‚»ãƒ¬ã‚¯ã‚¿
        text (str): å…¥åŠ›ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ
        timeout (int): è¦ç´ ãŒå…¥åŠ›å¯èƒ½ã«ãªã‚‹ã¾ã§ã®å¾…æ©Ÿæ™‚é–“ï¼ˆç§’ï¼‰
        verify (bool): å…¥åŠ›å†…å®¹ã‚’ç¢ºèªã™ã‚‹ã‹
        log_level (int): ãƒ­ã‚°ã®è©³ç´°åº¦
    """
    logging.getLogger().setLevel(log_level)
    
    try:
        logging.info(f"CSSã‚»ãƒ¬ã‚¯ã‚¿ '{css_selector}' ã¸ã®å…¥åŠ›ã‚’é–‹å§‹ã—ã¾ã™...")
        
        # è¦ç´ ãŒã‚¯ãƒªãƒƒã‚¯å¯èƒ½ã«ãªã‚‹ã¾ã§å¾…æ©Ÿ
        form = WebDriverWait(driver, timeout).until(
            EC.element_to_be_clickable((By.CSS_SELECTOR, css_selector))
        )
        
        # å…¥åŠ›å‡¦ç†
        form.clear()
        form.send_keys(text)
        
        # å…¥åŠ›ç¢ºèª
        if verify:
            actual_value = form.get_attribute('value')
            if actual_value == text:
                logging.info(f"âœ… CSSã‚»ãƒ¬ã‚¯ã‚¿ '{css_selector}' ã« '{text}' ã‚’æ­£ã—ãå…¥åŠ›ã—ã¾ã—ãŸ")
            else:
                logging.warning(f"âš ï¸ CSSã‚»ãƒ¬ã‚¯ã‚¿ '{css_selector}' ã«å…¥åŠ›ãŒæ­£ã—ãåæ˜ ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ")
                logging.warning(f"æœŸå¾…å€¤: '{text}', å®Ÿéš›: '{actual_value}'")
        else:
            logging.info(f"CSSã‚»ãƒ¬ã‚¯ã‚¿ '{css_selector}' ã« '{text}' ã‚’å…¥åŠ›ã—ã¾ã—ãŸ")
            
    except TimeoutException:
        logging.error(f"âŒ ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: CSSã‚»ãƒ¬ã‚¯ã‚¿ '{css_selector}' ã®è¦ç´ ãŒ{timeout}ç§’ä»¥å†…ã«æº–å‚™ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ")
    except NoSuchElementException:
        logging.error(f"âŒ è¦ç´ æœªæ¤œå‡º: CSSã‚»ãƒ¬ã‚¯ã‚¿ '{css_selector}' ã®è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ")
    except ElementNotInteractableException:
        logging.error(f"âŒ æ“ä½œä¸èƒ½: CSSã‚»ãƒ¬ã‚¯ã‚¿ '{css_selector}' ã®è¦ç´ ãŒéè¡¨ç¤ºã¾ãŸã¯ç„¡åŠ¹ã§ã™")
    except WebDriverException as e:
        logging.error(f"âŒ WebDriverã‚¨ãƒ©ãƒ¼: {e}")
    except Exception as e:
        logging.error(f"âŒ äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼: {e}")


# ==================== å†è©¦è¡Œæ©Ÿèƒ½ä»˜ãé–¢æ•° ====================

def input_text_with_retries(driver, selector, text, by_type="xpath", timeout=10, retries=3):
    """
    å†è©¦è¡Œæ©Ÿèƒ½ä»˜ããƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›é–¢æ•°
    
    Args:
        driver: WebDriverã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        selector: XPathã¾ãŸã¯CSSã‚»ãƒ¬ã‚¯ã‚¿
        text: å…¥åŠ›ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ
        by_type: "xpath" ã¾ãŸã¯ "css"
        timeout: å¾…æ©Ÿæ™‚é–“ï¼ˆç§’ï¼‰
        retries: å†è©¦è¡Œå›æ•°
    """
    for attempt in range(retries):
        try:
            logging.info(f"å…¥åŠ›è©¦è¡Œ {attempt + 1}/{retries}...")
            
            if by_type == "xpath":
                input_text_by_xpath(driver, selector, text, timeout, verify=True)
            else:
                input_text_by_css(driver, selector, text, timeout, verify=True)
            
            logging.info(f"âœ… å…¥åŠ›æˆåŠŸï¼ˆè©¦è¡Œå›æ•°: {attempt + 1}ï¼‰")
            return True
            
        except (TimeoutException, ElementNotInteractableException) as e:
            logging.warning(f"âš ï¸ è©¦è¡Œ {attempt + 1}/{retries} å¤±æ•—: {e}")
            if attempt < retries - 1:
                wait_time = 2 * (attempt + 1)  # æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•
                logging.info(f"â±ï¸ {wait_time}ç§’å¾…æ©Ÿã—ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¾ã™...")
                time.sleep(wait_time)
            else:
                logging.error(f"âŒ {retries}å›ã®è©¦è¡Œã™ã¹ã¦ãŒå¤±æ•—ã—ã¾ã—ãŸ")
                return False


def click_with_retries(driver, selector, by_type="css", timeout=10, retries=3):
    """
    å†è©¦è¡Œæ©Ÿèƒ½ä»˜ãã‚¯ãƒªãƒƒã‚¯é–¢æ•°
    
    Args:
        driver: WebDriverã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        selector: XPathã¾ãŸã¯CSSã‚»ãƒ¬ã‚¯ã‚¿
        by_type: "xpath" ã¾ãŸã¯ "css"
        timeout: å¾…æ©Ÿæ™‚é–“ï¼ˆç§’ï¼‰
        retries: å†è©¦è¡Œå›æ•°
    """
    for attempt in range(retries):
        try:
            logging.info(f"ã‚¯ãƒªãƒƒã‚¯è©¦è¡Œ {attempt + 1}/{retries}...")
            
            by = By.CSS_SELECTOR if by_type == "css" else By.XPATH
            element = WebDriverWait(driver, timeout).until(
                EC.element_to_be_clickable((by, selector))
            )
            element.click()
            
            logging.info(f"âœ… ã‚¯ãƒªãƒƒã‚¯æˆåŠŸï¼ˆè©¦è¡Œå›æ•°: {attempt + 1}ï¼‰")
            return True
            
        except (TimeoutException, ElementNotInteractableException) as e:
            logging.warning(f"âš ï¸ è©¦è¡Œ {attempt + 1}/{retries} å¤±æ•—: {e}")
            if attempt < retries - 1:
                wait_time = 2 * (attempt + 1)
                logging.info(f"â±ï¸ {wait_time}ç§’å¾…æ©Ÿã—ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¾ã™...")
                time.sleep(wait_time)
            else:
                logging.error(f"âŒ {retries}å›ã®è©¦è¡Œã™ã¹ã¦ãŒå¤±æ•—ã—ã¾ã—ãŸ")
                return False


# ==================== å¯è¦–æ€§ç¢ºèªä»˜ãã‚¯ãƒªãƒƒã‚¯ ====================

def click_element_safe(driver, selector, by_type="css", timeout=10, check_visibility=True):
    """
    å¯è¦–æ€§ç¢ºèªä»˜ãå®‰å…¨ãªã‚¯ãƒªãƒƒã‚¯é–¢æ•°
    
    Args:
        driver: WebDriverã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        selector: XPathã¾ãŸã¯CSSã‚»ãƒ¬ã‚¯ã‚¿
        by_type: "xpath" ã¾ãŸã¯ "css"
        timeout: å¾…æ©Ÿæ™‚é–“ï¼ˆç§’ï¼‰
        check_visibility: å¯è¦–æ€§ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‹
    """
    try:
        by = By.CSS_SELECTOR if by_type == "css" else By.XPATH
        
        if check_visibility:
            logging.info(f"è¦ç´ ã®å¯è¦–æ€§ã‚’ç¢ºèªä¸­: {selector}")
            element = WebDriverWait(driver, timeout).until(
                EC.visibility_of_element_located((by, selector))
            )
            
            if not element.is_displayed():
                raise ElementNotInteractableException(f"è¦ç´ ãŒéè¡¨ç¤ºã§ã™: {selector}")
            
        # ã‚¯ãƒªãƒƒã‚¯å¯èƒ½ã¾ã§å¾…æ©Ÿ
        element = WebDriverWait(driver, timeout).until(
            EC.element_to_be_clickable((by, selector))
        )
        element.click()
        
        logging.info(f"âœ… {by_type.upper()}ã‚»ãƒ¬ã‚¯ã‚¿ '{selector}' ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã—ãŸ")
        return True
        
    except TimeoutException:
        logging.error(f"âŒ ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: '{selector}' ãŒ{timeout}ç§’ä»¥å†…ã«ã‚¯ãƒªãƒƒã‚¯å¯èƒ½ã«ãªã‚Šã¾ã›ã‚“ã§ã—ãŸ")
        return False
    except ElementNotInteractableException as e:
        logging.error(f"âŒ æ“ä½œä¸èƒ½: {e}")
        return False
    except Exception as e:
        logging.error(f"âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
        return False


# ==================== ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆï¼ˆãƒ­ã‚°ä»˜ãï¼‰ ====================

def take_screenshot(driver, filename="screenshot.png"):
    """ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ’®å½±ã—ã¦ä¿å­˜ã™ã‚‹ï¼ˆãƒ­ã‚°ä»˜ãï¼‰"""
    try:
        directory = os.path.dirname(filename)
        if directory:
            os.makedirs(directory, exist_ok=True)
        
        driver.save_screenshot(filename)
        logging.info(f"ğŸ“¸ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ä¿å­˜: {filename}")
        return True
        
    except WebDriverException as e:
        logging.error(f"âŒ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ’®å½±ã‚¨ãƒ©ãƒ¼: {e}")
        return False
    except Exception as e:
        logging.error(f"âŒ äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼: {e}")
        return False


# ==================== å®Ÿè·µä¾‹ ====================

def create_advanced_test_html():
    """é«˜åº¦ãªãƒ†ã‚¹ãƒˆç”¨HTMLã‚’ä½œæˆ"""
    html_content = """
    <!DOCTYPE html>
    <html lang="ja">
    <head>
        <meta charset="UTF-8">
        <title>Seleniumé«˜åº¦ãƒ†ã‚¹ãƒˆ</title>
        <style>
            body { 
                font-family: 'Arial', sans-serif; 
                padding: 40px; 
                background: #f5f5f5;
            }
            .container {
                background: white;
                padding: 30px;
                border-radius: 10px;
                max-width: 700px;
                margin: 0 auto;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            }
            h1 { color: #2c3e50; }
            .form-group {
                margin: 20px 0;
            }
            label {
                display: block;
                margin-bottom: 5px;
                font-weight: bold;
                color: #34495e;
            }
            input[type="text"], input[type="email"] {
                width: 100%;
                padding: 10px;
                border: 2px solid #ddd;
                border-radius: 5px;
                font-size: 14px;
                box-sizing: border-box;
            }
            input:focus {
                border-color: #3498db;
                outline: none;
            }
            button {
                padding: 12px 30px;
                margin: 10px 5px;
                border: none;
                border-radius: 5px;
                font-size: 16px;
                cursor: pointer;
                transition: all 0.3s;
            }
            .btn-primary {
                background: #3498db;
                color: white;
            }
            .btn-primary:hover {
                background: #2980b9;
            }
            .btn-secondary {
                background: #95a5a6;
                color: white;
            }
            #result {
                margin-top: 20px;
                padding: 15px;
                background: #ecf0f1;
                border-radius: 5px;
                min-height: 50px;
            }
            .hidden { display: none; }
            .delayed {
                opacity: 0;
                transition: opacity 2s;
            }
            .delayed.show {
                opacity: 1;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>ğŸš€ Seleniumé«˜åº¦ãƒ†ã‚¹ãƒˆ</h1>
            
            <div class="form-group">
                <label for="username">ãƒ¦ãƒ¼ã‚¶ãƒ¼å (XPathç”¨)</label>
                <input type="text" id="username" placeholder="ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å…¥åŠ›">
            </div>
            
            <div class="form-group">
                <label for="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ (CSSç”¨)</label>
                <input type="email" class="email-field" placeholder="email@example.com">
            </div>
            
            <div class="form-group">
                <label for="password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ (é…å»¶è¡¨ç¤ºãƒ†ã‚¹ãƒˆ)</label>
                <input type="text" id="delayed-input" class="delayed" placeholder="2ç§’å¾Œã«è¡¨ç¤º">
            </div>
            
            <button class="btn-primary" id="submit-btn" onclick="showResult()">é€ä¿¡</button>
            <button class="btn-secondary" id="reset-btn" onclick="resetForm()">ãƒªã‚»ãƒƒãƒˆ</button>
            
            <div id="result"></div>
        </div>
        
        <script>
            // é…å»¶è¡¨ç¤º
            setTimeout(() => {
                document.getElementById('delayed-input').classList.add('show');
            }, 2000);
            
            function showResult() {
                const username = document.getElementById('username').value;
                const email = document.querySelector('.email-field').value;
                const result = document.getElementById('result');
                result.innerHTML = `
                    <strong>âœ… ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æˆåŠŸ!</strong><br>
                    ãƒ¦ãƒ¼ã‚¶ãƒ¼å: ${username}<br>
                    ãƒ¡ãƒ¼ãƒ«: ${email}<br>
                    æ™‚åˆ»: ${new Date().toLocaleTimeString('ja-JP')}
                `;
            }
            
            function resetForm() {
                document.getElementById('username').value = '';
                document.querySelector('.email-field').value = '';
                document.getElementById('result').innerHTML = '';
            }
        </script>
    </body>
    </html>
    """
    
    with open("selenium_advanced_test.html", "w", encoding="utf-8") as f:
        f.write(html_content)
    
    return os.path.abspath("selenium_advanced_test.html")


def main():
    """å…¨æ©Ÿèƒ½ã‚’ä½¿ã£ãŸç·åˆãƒ†ã‚¹ãƒˆï¼ˆãƒ­ã‚°ãƒ»å†è©¦è¡Œä»˜ãï¼‰"""
    
    # ãƒ­ã‚°è¨­å®š
    setup_logging(log_file="logs/selenium_test.log", level=logging.INFO)
    
    # ãƒ†ã‚¹ãƒˆHTMLä½œæˆ
    html_path = create_advanced_test_html()
    logging.info(f"ãƒ†ã‚¹ãƒˆHTMLã‚’ä½œæˆ: {html_path}")
    
    # WebDriverèµ·å‹•
    driver = webdriver.Chrome()
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    
    try:
        # HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã
        driver.get(f"file:///{html_path}")
        logging.info("ğŸŒ ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‚’é–‹ãã¾ã—ãŸ")
        time.sleep(2)
        
        # åˆæœŸã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
        take_screenshot(driver, f"screenshots/00_initial_{timestamp}.png")
        
        # ===== å…¥åŠ›ç¢ºèªãƒ†ã‚¹ãƒˆ =====
        logging.info("\n" + "="*60)
        logging.info("ğŸ“ å…¥åŠ›ç¢ºèªãƒ†ã‚¹ãƒˆé–‹å§‹")
        logging.info("="*60)
        
        input_text_by_xpath(driver, '//input[@id="username"]', "testuser123", verify=True)
        time.sleep(1)
        
        input_text_by_css(driver, ".email-field", "test@example.com", verify=True)
        time.sleep(1)
        
        take_screenshot(driver, f"screenshots/01_inputs_{timestamp}.png")
        
        # ===== å†è©¦è¡Œãƒ†ã‚¹ãƒˆ =====
        logging.info("\n" + "="*60)
        logging.info("ğŸ”„ å†è©¦è¡Œæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ")
        logging.info("="*60)
        
        # é…å»¶è¡¨ç¤ºã•ã‚Œã‚‹è¦ç´ ã«å¯¾ã™ã‚‹å†è©¦è¡Œ
        input_text_with_retries(
            driver, 
            '#delayed-input', 
            'password123', 
            by_type="css",
            timeout=15,
            retries=3
        )
        time.sleep(1)
        
        take_screenshot(driver, f"screenshots/02_delayed_input_{timestamp}.png")
        
        # ===== å¯è¦–æ€§ç¢ºèªä»˜ãã‚¯ãƒªãƒƒã‚¯ =====
        logging.info("\n" + "="*60)
        logging.info("ğŸ‘† å¯è¦–æ€§ç¢ºèªä»˜ãã‚¯ãƒªãƒƒã‚¯")
        logging.info("="*60)
        
        click_element_safe(driver, "#submit-btn", by_type="css", check_visibility=True)
        time.sleep(2)
        
        take_screenshot(driver, f"screenshots/03_submitted_{timestamp}.png")
        
        # ===== å†è©¦è¡Œã‚¯ãƒªãƒƒã‚¯ =====
        logging.info("\n" + "="*60)
        logging.info("ğŸ”„ å†è©¦è¡Œã‚¯ãƒªãƒƒã‚¯ãƒ†ã‚¹ãƒˆ")
        logging.info("="*60)
        
        click_with_retries(driver, "#reset-btn", by_type="css", retries=3)
        time.sleep(2)
        
        take_screenshot(driver, f"screenshots/04_reset_{timestamp}.png")
        
        logging.info("\n" + "="*60)
        logging.info("âœ… å…¨ã¦ã®ãƒ†ã‚¹ãƒˆãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸï¼")
        logging.info("="*60)
        
    except Exception as e:
        logging.error(f"\nâŒ è‡´å‘½çš„ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ: {e}", exc_info=True)
        take_screenshot(driver, f"screenshots/error_{timestamp}.png")
    
    finally:
        time.sleep(3)
        driver.quit()
        logging.info("ğŸ”š ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã¾ã—ãŸ")
        logging.info("="*60)
        logging.info("Seleniumè‡ªå‹•åŒ–ãƒ­ã‚°çµ‚äº†")
        logging.info("="*60)


if __name__ == "__main__":
    main()
```

## å®Ÿè¡Œçµæœã®ä¾‹ï¼ˆãƒ­ã‚°å‡ºåŠ›ï¼‰

```
2025-01-05 14:45:22 - INFO - [setup_logging] ============================================================
2025-01-05 14:45:22 - INFO - [setup_logging] Seleniumè‡ªå‹•åŒ–ãƒ­ã‚°é–‹å§‹
2025-01-05 14:45:22 - INFO - [setup_logging] ============================================================
2025-01-05 14:45:22 - INFO - [main] ãƒ†ã‚¹ãƒˆHTMLã‚’ä½œæˆ: /path/to/selenium_advanced_test.html
2025-01-05 14:45:25 - INFO - [main] ğŸŒ ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‚’é–‹ãã¾ã—ãŸ
2025-01-05 14:45:27 - INFO - [take_screenshot] ğŸ“¸ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ä¿å­˜: screenshots/00_initial_20250105_144522.png

============================================================
2025-01-05 14:45:27 - INFO - [main] ğŸ“ å…¥åŠ›ç¢ºèªãƒ†ã‚¹ãƒˆé–‹å§‹
============================================================
2025-01-05 14:45:27 - INFO - [input_text_by_xpath] XPath '//input[@id="username"]' ã¸ã®å…¥åŠ›ã‚’é–‹å§‹ã—ã¾ã™...
2025-01-05 14:45:27 - INFO - [input_text_by_xpath] âœ… XPath '//input[@id="username"]' ã« 'testuser123' ã‚’æ­£ã—ãå…¥åŠ›ã—ã¾ã—ãŸ
2025-01-05 14:45:28 - INFO - [input_text_by_css] CSSã‚»ãƒ¬ã‚¯ã‚¿ '.email-field' ã¸ã®å…¥åŠ›ã‚’é–‹å§‹ã—ã¾ã™...
2025-01-05 14:45:28 - INFO - [input_text_by_css] âœ… CSSã‚»ãƒ¬ã‚¯ã‚¿ '.email-field' ã« 'test@example.com' ã‚’æ­£ã—ãå…¥åŠ›ã—ã¾ã—ãŸ
2025-01-05 14:45:29 - INFO - [take_screenshot] ğŸ“¸ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ä¿å­˜: screenshots/01_inputs_20250105_144522.png

============================================================
2025-01-05 14:45:29 - INFO - [main] ğŸ”„ å†è©¦è¡Œæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
============================================================
2025-01-05 14:45:29 - INFO - [input_text_with_retries] å…¥åŠ›è©¦è¡Œ 1/3...
2025-01-05 14:45:29 - INFO - [input_text_by_css] CSSã‚»ãƒ¬ã‚¯ã‚¿ '#delayed-input' ã¸ã®å…¥åŠ›ã‚’é–‹å§‹ã—ã¾ã™...
2025-01-05 14:45:31 - INFO - [input_text_by_css] âœ… CSSã‚»ãƒ¬ã‚¯ã‚¿ '#delayed-input' ã« 'password123' ã‚’æ­£ã—ãå…¥åŠ›ã—ã¾ã—ãŸ
2025-01-05 14:45:31 - INFO - [input_text_with_retries] âœ… å…¥åŠ›æˆåŠŸï¼ˆè©¦è¡Œå›æ•°: 1ï¼‰

============================================================
2025-01-05 14:45:34 - INFO - [main] âœ… å…¨ã¦ã®ãƒ†ã‚¹ãƒˆãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸï¼
============================================================
```

## ã¾ã¨ã‚

### è¿½åŠ ã•ã‚ŒãŸå¼·åŠ›ãªæ©Ÿèƒ½

1. **âœ… å…¥åŠ›ç¢ºèªæ©Ÿèƒ½**
   - `verify=True`ã§å…¥åŠ›å†…å®¹ã‚’è‡ªå‹•æ¤œè¨¼
   - æœŸå¾…å€¤ã¨å®Ÿéš›ã®å€¤ã‚’æ¯”è¼ƒ

2. **ğŸ”„ å†è©¦è¡Œæ©Ÿèƒ½**
   - æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•ã§å†è©¦è¡Œ
   - ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚„æ“ä½œä¸èƒ½ã‚¨ãƒ©ãƒ¼ã«è‡ªå‹•å¯¾å¿œ

3. **ğŸ“Š è©³ç´°ãªãƒ­ã‚°è¨˜éŒ²**
   - ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®ä¸¡æ–¹ã«å‡ºåŠ›
   - ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã€é–¢æ•°åã€ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ä»˜ã

4. **ğŸ‘ï¸ å¯è¦–æ€§ç¢ºèª**
   - è¦ç´ ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
   - éè¡¨ç¤ºè¦ç´ ã¸ã®ã‚¨ãƒ©ãƒ¼æ“ä½œã‚’é˜²æ­¢

ã“ã‚Œã§ã€ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ç’°å¢ƒã§ã‚‚ä½¿ãˆã‚‹å …ç‰¢ãªSeleniumè‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ãŒå®Œæˆã—ã¾ã—ãŸ! ğŸ‰
