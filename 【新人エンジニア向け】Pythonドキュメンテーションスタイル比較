"""
ã€æ–°äººã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢å‘ã‘ã€‘Pythonãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«æ¯”è¼ƒ
Google / NumPy / reStructuredText / Epytext / å‹ãƒ’ãƒ³ãƒˆ

ä½¿ã„æ–¹ï¼š
VSCodeã§å®Ÿè¡Œãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã‹ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ `python ãƒ•ã‚¡ã‚¤ãƒ«å.py` ã‚’å®Ÿè¡Œ
"""

from typing import List, Dict, Optional


# ============================================================
# ã‚¹ã‚¿ã‚¤ãƒ«1: Google Styleï¼ˆGoogleã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
# ============================================================
def calculate_tax_google(price: float, tax_rate: float = 0.1) -> float:
    """æ¶ˆè²»ç¨ã‚’è¨ˆç®—ã™ã‚‹ï¼ˆGoogleã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
    
    Args:
        price (float): å•†å“ã®ä¾¡æ ¼
        tax_rate (float, optional): æ¶ˆè²»ç¨ç‡. Defaults to 0.1.
    
    Returns:
        float: æ¶ˆè²»ç¨é¡
    
    Examples:
        >>> calculate_tax_google(1000)
        100.0
    """
    return price * tax_rate


class ShopGoogle:
    """ãŠåº—ã‚¯ãƒ©ã‚¹ï¼ˆGoogleã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
    
    Attributes:
        name (str): ãŠåº—ã®åå‰
        stock (int): åœ¨åº«æ•°
        sales (float): å£²ä¸Šé‡‘é¡
    """
    
    def __init__(self, name: str) -> None:
        """åˆæœŸåŒ–
        
        Args:
            name (str): ãŠåº—ã®åå‰
        """
        self.name: str = name
        self.stock: int = 0
        self.sales: float = 0.0
    
    def add_stock(self, count: int) -> None:
        """åœ¨åº«ã‚’è¿½åŠ 
        
        Args:
            count (int): è¿½åŠ ã™ã‚‹å€‹æ•°
        """
        self.stock += count
        print(f"ğŸ“¦ {count}å€‹è¿½åŠ  â†’ åœ¨åº«{self.stock}å€‹")
    
    def sell(self, count: int, price: float) -> bool:
        """å•†å“ã‚’è²©å£²
        
        Args:
            count (int): è²©å£²å€‹æ•°
            price (float): å˜ä¾¡
        
        Returns:
            bool: è²©å£²æˆåŠŸãªã‚‰Trueã€åœ¨åº«ä¸è¶³ãªã‚‰False
        """
        if self.stock >= count:
            self.stock -= count
            self.sales += count * price
            print(f"ğŸ’° {count}å€‹è²©å£² â†’ å£²ä¸Š{count * price}å††")
            return True
        else:
            print("âš ï¸ åœ¨åº«ä¸è¶³")
            return False


# ============================================================
# ã‚¹ã‚¿ã‚¤ãƒ«2: NumPy Styleï¼ˆNumPyã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
# ============================================================
def calculate_total_numpy(price: float, tax_rate: float = 0.1) -> Dict[str, float]:
    """åˆè¨ˆé‡‘é¡ã‚’è¨ˆç®—ã™ã‚‹ï¼ˆNumPyã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
    
    Parameters
    ----------
    price : float
        å•†å“ã®ä¾¡æ ¼
    tax_rate : float, optional
        æ¶ˆè²»ç¨ç‡, by default 0.1
    
    Returns
    -------
    Dict[str, float]
        ä¾¡æ ¼ã€ç¨é¡ã€åˆè¨ˆã‚’å«ã‚€è¾æ›¸
        - 'price': å…ƒã®ä¾¡æ ¼
        - 'tax': æ¶ˆè²»ç¨é¡
        - 'total': åˆè¨ˆé‡‘é¡
    
    Examples
    --------
    >>> result = calculate_total_numpy(1000)
    >>> result['total']
    1100.0
    """
    tax = price * tax_rate
    total = price + tax
    return {
        'price': price,
        'tax': tax,
        'total': total
    }


class ShopNumPy:
    """ãŠåº—ã‚¯ãƒ©ã‚¹ï¼ˆNumPyã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
    
    Parameters
    ----------
    name : str
        ãŠåº—ã®åå‰
    
    Attributes
    ----------
    name : str
        ãŠåº—ã®åå‰
    stock : int
        åœ¨åº«æ•°
    sales : float
        å£²ä¸Šé‡‘é¡
    """
    
    def __init__(self, name: str) -> None:
        self.name: str = name
        self.stock: int = 0
        self.sales: float = 0.0
    
    def process_sales(self, items: List[int], price: float) -> float:
        """è¤‡æ•°ã®è²©å£²ã‚’å‡¦ç†
        
        Parameters
        ----------
        items : List[int]
            å„è²©å£²ã®å€‹æ•°ãƒªã‚¹ãƒˆ
        price : float
            å˜ä¾¡
        
        Returns
        -------
        float
            ç·å£²ä¸Šé‡‘é¡
        """
        total_sales = 0.0
        for count in items:
            if self.stock >= count:
                self.stock -= count
                sale = count * price
                total_sales += sale
                print(f"ğŸ’° {count}å€‹è²©å£²")
            else:
                print("âš ï¸ åœ¨åº«ä¸è¶³ã§ã‚¹ã‚­ãƒƒãƒ—")
        
        self.sales += total_sales
        return total_sales


# ============================================================
# ã‚¹ã‚¿ã‚¤ãƒ«3: reStructuredText Styleï¼ˆreSTï¼‰
# ============================================================
def calculate_discount_rest(price: float, discount_rate: float) -> float:
    """å‰²å¼•å¾Œã®ä¾¡æ ¼ã‚’è¨ˆç®—ã™ã‚‹ï¼ˆreStructuredTextã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
    
    :param price: å•†å“ã®ä¾¡æ ¼
    :type price: float
    :param discount_rate: å‰²å¼•ç‡ï¼ˆ0.0ã€œ1.0ï¼‰
    :type discount_rate: float
    :return: å‰²å¼•å¾Œã®ä¾¡æ ¼
    :rtype: float
    :raises ValueError: discount_rateãŒ0ã€œ1ã®ç¯„å›²å¤–ã®å ´åˆ
    
    .. note::
        å‰²å¼•ç‡ã¯0.0ï¼ˆå‰²å¼•ãªã—ï¼‰ã‹ã‚‰1.0ï¼ˆ100%å‰²å¼•ï¼‰ã®ç¯„å›²ã§æŒ‡å®š
    
    .. code-block:: python
    
        >>> calculate_discount_rest(1000, 0.2)
        800.0
    """
    if not 0 <= discount_rate <= 1:
        raise ValueError("å‰²å¼•ç‡ã¯0ã€œ1ã®ç¯„å›²ã§æŒ‡å®šã—ã¦ãã ã•ã„")
    
    return price * (1 - discount_rate)


class ShopReST:
    """ãŠåº—ã‚¯ãƒ©ã‚¹ï¼ˆreStructuredTextã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
    
    :param name: ãŠåº—ã®åå‰
    :type name: str
    
    :ivar name: ãŠåº—ã®åå‰
    :vartype name: str
    :ivar stock: åœ¨åº«æ•°
    :vartype stock: int
    :ivar sales: å£²ä¸Šé‡‘é¡
    :vartype sales: float
    """
    
    def __init__(self, name: str) -> None:
        self.name: str = name
        self.stock: int = 0
        self.sales: float = 0.0
    
    def get_status(self) -> Dict[str, any]:
        """ãŠåº—ã®çŠ¶æ…‹ã‚’å–å¾—
        
        :return: ãŠåº—ã®çŠ¶æ…‹ã‚’å«ã‚€è¾æ›¸
        :rtype: Dict[str, any]
        
        :Example:
        
        >>> shop = ShopReST("å¤§ç¦åº—")
        >>> shop.get_status()
        {'name': 'å¤§ç¦åº—', 'stock': 0, 'sales': 0.0}
        """
        return {
            'name': self.name,
            'stock': self.stock,
            'sales': self.sales
        }


# ============================================================
# ã‚¹ã‚¿ã‚¤ãƒ«4: Epytext Styleï¼ˆEpydocï¼‰
# ============================================================
def format_price_epytext(price: float, currency: str = "å††") -> str:
    """ä¾¡æ ¼ã‚’æ•´å½¢ã—ã¦æ–‡å­—åˆ—ã§è¿”ã™ï¼ˆEpytextã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
    
    @param price: ä¾¡æ ¼
    @type price: float
    @param currency: é€šè²¨å˜ä½
    @type currency: str
    @return: æ•´å½¢ã•ã‚ŒãŸä¾¡æ ¼æ–‡å­—åˆ—
    @rtype: str
    
    @note: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®é€šè²¨ã¯ã€Œå††ã€
    
    @example:
        >>> format_price_epytext(1000)
        '1,000å††'
        >>> format_price_epytext(1234.56, "USD")
        '1,234.56USD'
    """
    formatted = f"{price:,.2f}" if '.' in str(price) else f"{int(price):,}"
    return f"{formatted}{currency}"


class ShopEpytext:
    """ãŠåº—ã‚¯ãƒ©ã‚¹ï¼ˆEpytextã‚¹ã‚¿ã‚¤ãƒ«ï¼‰
    
    @ivar name: ãŠåº—ã®åå‰
    @type name: str
    @ivar stock: åœ¨åº«æ•°
    @type stock: int
    @ivar sales: å£²ä¸Šé‡‘é¡
    @type sales: float
    """
    
    def __init__(self, name: str) -> None:
        """ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
        
        @param name: ãŠåº—ã®åå‰
        @type name: str
        """
        self.name: str = name
        self.stock: int = 0
        self.sales: float = 0.0
    
    def display_info(self) -> None:
        """ãŠåº—ã®æƒ…å ±ã‚’è¡¨ç¤º
        
        @return: None
        @rtype: None
        """
        print(f"ğŸª {self.name}")
        print(f"   åœ¨åº«: {self.stock}å€‹")
        print(f"   å£²ä¸Š: {format_price_epytext(self.sales)}")


# ============================================================
# ã‚¹ã‚¿ã‚¤ãƒ«5: å‹ãƒ’ãƒ³ãƒˆé‡è¦–ï¼ˆType Hintsï¼‰
# ============================================================
def process_order(
    items: List[Dict[str, any]],
    discount: Optional[float] = None
) -> Dict[str, float]:
    """æ³¨æ–‡ã‚’å‡¦ç†ã™ã‚‹ï¼ˆå‹ãƒ’ãƒ³ãƒˆé‡è¦–ï¼‰
    
    å®Œå…¨ãªå‹ãƒ’ãƒ³ãƒˆã§ã€IDEã®è£œå®Œã¨ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ã‚’æœ€å¤§åŒ–
    """
    total: float = 0.0
    
    for item in items:
        price: float = item.get('price', 0.0)
        count: int = item.get('count', 0)
        subtotal: float = price * count
        total += subtotal
    
    if discount is not None:
        total *= (1 - discount)
    
    return {
        'subtotal': total,
        'discount': discount or 0.0,
        'total': total
    }


class ShopTypeHints:
    """å‹ãƒ’ãƒ³ãƒˆé‡è¦–ã®ãŠåº—ã‚¯ãƒ©ã‚¹"""
    
    name: str
    stock: int
    sales: float
    products: List[Dict[str, any]]
    
    def __init__(self, name: str) -> None:
        self.name = name
        self.stock = 0
        self.sales = 0.0
        self.products = []
    
    def add_product(
        self,
        name: str,
        price: float,
        count: int
    ) -> None:
        """å•†å“ã‚’è¿½åŠ """
        product: Dict[str, any] = {
            'name': name,
            'price': price,
            'count': count
        }
        self.products.append(product)
        self.stock += count
    
    def get_total_value(self) -> float:
        """åœ¨åº«ã®ç·é¡ã‚’è¨ˆç®—"""
        total: float = 0.0
        product: Dict[str, any]
        
        for product in self.products:
            total += product['price'] * product['count']
        
        return total


# ============================================================
# ğŸ° å®Ÿè·µä¾‹: ã†ã•ã†ã•åº—é•·ï¼ˆå…¨ã‚¹ã‚¿ã‚¤ãƒ«çµ±åˆï¼‰
# ============================================================
def demo_all_styles() -> None:
    """å…¨ã¦ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«ã®ãƒ‡ãƒ¢"""
    
    print("=" * 60)
    print("ğŸ° ã†ã•ã†ã•åº—é•·ã®ãµã‚ãµã‚å¤§ç¦åº—")
    print("=" * 60)
    
    # Googleã‚¹ã‚¿ã‚¤ãƒ«
    print("\nã€Googleã‚¹ã‚¿ã‚¤ãƒ«ã€‘")
    shop_google = ShopGoogle("ãµã‚ãµã‚å¤§ç¦åº—ï¼ˆGoogleï¼‰")
    shop_google.add_stock(20)
    shop_google.sell(3, 300)
    
    # NumPyã‚¹ã‚¿ã‚¤ãƒ«
    print("\nã€NumPyã‚¹ã‚¿ã‚¤ãƒ«ã€‘")
    shop_numpy = ShopNumPy("ãµã‚ãµã‚å¤§ç¦åº—ï¼ˆNumPyï¼‰")
    shop_numpy.stock = 20
    sales = shop_numpy.process_sales([2, 3, 1], 300)
    print(f"ç·å£²ä¸Š: {sales}å††")
    
    # reSTã‚¹ã‚¿ã‚¤ãƒ«
    print("\nã€reStructuredTextã‚¹ã‚¿ã‚¤ãƒ«ã€‘")
    shop_rest = ShopReST("ãµã‚ãµã‚å¤§ç¦åº—ï¼ˆreSTï¼‰")
    shop_rest.stock = 20
    status = shop_rest.get_status()
    print(f"çŠ¶æ…‹: {status}")
    
    # Epytextã‚¹ã‚¿ã‚¤ãƒ«
    print("\nã€Epytextã‚¹ã‚¿ã‚¤ãƒ«ã€‘")
    shop_epytext = ShopEpytext("ãµã‚ãµã‚å¤§ç¦åº—ï¼ˆEpytextï¼‰")
    shop_epytext.stock = 20
    shop_epytext.sales = 1800
    shop_epytext.display_info()
    
    # å‹ãƒ’ãƒ³ãƒˆé‡è¦–
    print("\nã€å‹ãƒ’ãƒ³ãƒˆé‡è¦–ã€‘")
    shop_hints = ShopTypeHints("ãµã‚ãµã‚å¤§ç¦åº—ï¼ˆTypeHintsï¼‰")
    shop_hints.add_product("ã„ã¡ã”å¤§ç¦", 350, 10)
    shop_hints.add_product("ã‚ã‚“ã“å¤§ç¦", 300, 10)
    total_value = shop_hints.get_total_value()
    print(f"åœ¨åº«ç·é¡: {total_value:,}å††")


# ============================================================
# ãƒ¡ã‚¤ãƒ³å‡¦ç†
# ============================================================
if __name__ == "__main__":
    print("ğŸ“ Pythonãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«æ¯”è¼ƒ\n")
    
    demo_all_styles()
    
    print("\n" + "=" * 60)
    print("âœ… å®Œäº†ï¼")
    print("=" * 60)
    print("""
ğŸ’¡ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«ã¾ã¨ã‚:

1. Google Style: ã‚·ãƒ³ãƒ—ãƒ«ã§èª­ã¿ã‚„ã™ã„ï¼ˆãŠã™ã™ã‚ï¼‰
2. NumPy Style: ç§‘å­¦è¨ˆç®—å‘ã‘ã€è©³ç´°ãªèª¬æ˜
3. reStructuredText: Sphinxç”¨ã€Pythonå…¬å¼
4. Epytext: Epydocç”¨ã€æ˜”ã‹ã‚‰ä½¿ã‚ã‚Œã¦ã„ã‚‹
5. å‹ãƒ’ãƒ³ãƒˆ: IDEè£œå®Œã€ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ã«æœ€é©

æ–°äººã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ã¯ã€ŒGoogle Style + å‹ãƒ’ãƒ³ãƒˆã€ãŒãŠã™ã™ã‚ï¼
""")
