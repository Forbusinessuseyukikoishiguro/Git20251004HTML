ã‚ˆã„è³ªå•ã§ã™ï¼

Python ã® `TimedRotatingFileHandler` ã‚’ä½¿ã£ã¦ **`app_YYYY-MM-DD.log` å½¢å¼ã®ãƒ•ã‚¡ã‚¤ãƒ«åã§ãƒ­ã‚°ã‚’ä¿å­˜ãƒ»æ—¥ä»˜ã§ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³** ã—ãŸã„å ´åˆã€å°‘ã—å·¥å¤«ãŒå¿…è¦ã§ã™ã€‚

---

## âœ… çµè«–ï¼š`TimedRotatingFileHandler` + `suffix` ã§æ—¥ä»˜ã¤ããƒ­ã‚°åã‚’å®Ÿç¾

```python
import os
import logging
from logging.handlers import TimedRotatingFileHandler

# --- ãƒ­ã‚°å‡ºåŠ›ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ ---
os.makedirs("logs", exist_ok=True)

# --- ãƒ­ã‚¬ãƒ¼ã‚’ä½œæˆ ---
logger = logging.getLogger(__name__)
logger.setLevel(logging.INFO)

# --- æ—¥æ™‚ä»˜ããƒ•ã‚¡ã‚¤ãƒ«åã®ãƒ™ãƒ¼ã‚¹ ---
log_path = "logs/app.log"  # ãƒ™ãƒ¼ã‚¹åï¼ˆã“ã“ã« .YYYY-MM-DD ãŒè‡ªå‹•ã§ä»˜ãï¼‰

# --- TimedRotatingFileHandlerã‚’è¨­å®š ---
file_handler = TimedRotatingFileHandler(
    filename=log_path,     # ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«å
    when="midnight",       # æ¯æ—¥0æ™‚ã«ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
    interval=1,            # 1æ—¥ã”ã¨
    backupCount=7,         # éå»7æ—¥åˆ†ä¿æŒ
    encoding="utf-8",
    utc=False              # ãƒ­ãƒ¼ã‚«ãƒ«æ™‚åˆ»åŸºæº–ï¼ˆTrueã«ã™ã‚‹ã¨UTCï¼‰
)

# --- ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«åã® suffix ã‚’æŒ‡å®š ---
file_handler.suffix = "%Y-%m-%d"  # app.log.2025-10-05 ã®å½¢å¼ã«ãªã‚‹

# --- ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’è¨­å®š ---
formatter = logging.Formatter('%(asctime)s [%(levelname)s] - %(message)s')
file_handler.setFormatter(formatter)

# --- ãƒ­ã‚¬ãƒ¼ã«ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’è¿½åŠ  ---
logger.addHandler(file_handler)

# --- ãƒ­ã‚°å‡ºåŠ›ãƒ†ã‚¹ãƒˆ ---
logger.info("ã“ã®ãƒ­ã‚°ã¯ app.log ã«å‡ºåŠ›ã•ã‚Œã€æ—¥ä»˜ã”ã¨ã« app.log.YYYY-MM-DD ã«åˆ†ã‹ã‚Œã¾ã™")
```

---

## âœ… å‡ºåŠ›ã•ã‚Œã‚‹ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆä¾‹ï¼‰

å®Ÿè¡Œåˆæ—¥ã¯ï¼š

```
logs/app.log   â† ä»Šæ—¥ã®ãƒ­ã‚°
```

ç¿Œæ—¥ã«ãªã‚Šãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã•ã‚Œã‚‹ã¨ï¼š

```
logs/app.log.2025-10-05
logs/app.log   â† æ–°ã—ã„ãƒ­ã‚°
```

ã“ã®ã‚ˆã†ã«ã€**ã€Œãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«å.app.logã€ï¼‹ã€Œæ—¥ä»˜ã€**ã®å½¢å¼ã§è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚

---

## âœ… æ³¨æ„ç‚¹

| é …ç›®                                                             | èª¬æ˜ |
| -------------------------------------------------------------- | -- |
| `file_handler.suffix` ã¯æ˜ç¤ºçš„ã«æŒ‡å®šã—ãªã„ã¨ã€`log.2025-10-05` ã®ã‚ˆã†ãªåå‰ã«ãªã‚‰ãªã„ |    |
| `when='midnight'` ã¯ `when='D'` ã¨åŒã˜æ„å‘³ï¼ˆ1æ—¥ã”ã¨ï¼‰                     |    |
| ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã¯æœ€åˆã¯ `app.log` ã«æ›¸ãè¾¼ã¾ã‚Œã€æ—¥ä»˜å¤‰æ›´æ™‚ã« `app.log.æ—¥ä»˜` ã«ãƒªãƒãƒ¼ãƒ ã•ã‚Œã‚‹       |    |

---

## âœ… ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼šç”»é¢ï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼‰ã«ã‚‚å‡ºã—ãŸã„å ´åˆ

```python
console_handler = logging.StreamHandler()
console_handler.setFormatter(formatter)
console_handler.setLevel(logging.INFO)
logger.addHandler(console_handler)
```

---

## âœ… æ—¥ä»˜ã‚’æœ€åˆã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«åã«å…¥ã‚ŒãŸã„å ´åˆï¼ˆä¾‹ï¼šapp_2025-10-05.logï¼‰

ã“ã‚Œã¯ **`TimedRotatingFileHandler`ã§ã¯ã§ãã¾ã›ã‚“ï¼ˆè‡ªå‹•ãƒªãƒãƒ¼ãƒ åˆ¶å¾¡ãŒå¼·åˆ¶ï¼‰**
ãã®ãŸã‚ã€ä»¥ä¸‹ã®ã©ã¡ã‚‰ã‹ãŒå¿…è¦ã«ãªã‚Šã¾ã™ï¼š

### âŒ NGï¼ˆTimedRotatingFileHandlerã§ custom nameï¼‰

```python
# TimedRotatingFileHandler ã§ã¯ã§ããªã„ä¾‹ï¼š
filename='logs/app_%Y-%m-%d.log'  # ç„¡åŠ¹
```

### âœ… OKï¼ˆè‡ªåˆ†ã§ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æ¯æ—¥åˆ‡ã‚Šæ›¿ãˆã‚‹ï¼‰

â†’ æ‰‹å‹•ã§ `datetime.now()` ã‚’ä½¿ã£ã¦ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ä½œã‚‹æ–¹æ³•ï¼ˆå‰å›èª¬æ˜æ¸ˆï¼‰

---

## âœ… ã¾ã¨ã‚

| ç›®çš„                                              | æ–¹æ³•                                                       |
| ----------------------------------------------- | -------------------------------------------------------- |
| `app.log.2025-10-05` å½¢å¼ã§æ—¥ã”ã¨ã«åˆ†ã‘ãŸã„                | âœ… `TimedRotatingFileHandler + suffix`                    |
| `app_2025-10-05.log` ã®ã‚ˆã†ã«**æœ€åˆã‹ã‚‰æ—¥ä»˜ä»˜ãã®ãƒ•ã‚¡ã‚¤ãƒ«å**ã«ã—ãŸã„ | âŒ `TimedRotatingFileHandler` ã§ã¯ä¸å¯ â†’ âœ… è‡ªåˆ†ã§ `datetime` ã§ç”Ÿæˆ |

---

## ğŸ“¦ ãƒ•ã‚¡ã‚¤ãƒ«åã‚’è‡ªç”±ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¤ã¤æ—¥ã”ã¨ã«ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã—ãŸã„å ´åˆ

â†’ è‡ªä½œã®ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚¿ãƒ¼ or å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆloguruãªã©ï¼‰ã®åˆ©ç”¨ãŒãŠã™ã™ã‚ã§ã™ã€‚

---

## âœ… æœ€å¾Œã«ï¼šå®Œå…¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ï¼‹ç”»é¢å‡ºåŠ›ãƒ»æ—¥åˆ¥ãƒ­ãƒ¼ãƒ†ï¼‰

```python
import os
import logging
from logging.handlers import TimedRotatingFileHandler

# ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
os.makedirs("logs", exist_ok=True)

# ãƒ­ã‚¬ãƒ¼ä½œæˆ
logger = logging.getLogger(__name__)
logger.setLevel(logging.INFO)

# ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼å®šç¾©
formatter = logging.Formatter('%(asctime)s [%(levelname)s] - %(message)s')

# æ—¥ã”ã¨ã«ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã•ã‚Œã‚‹ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆsuffixã‚ã‚Šï¼‰
file_handler = TimedRotatingFileHandler(
    filename='logs/app.log',
    when='midnight',
    interval=1,
    backupCount=7,
    encoding='utf-8'
)
file_handler.suffix = "%Y-%m-%d"
file_handler.setFormatter(formatter)

# ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”¨ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
console_handler = logging.StreamHandler()
console_handler.setFormatter(formatter)

# ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ç™»éŒ²
logger.addHandler(file_handler)
logger.addHandler(console_handler)

# ãƒ­ã‚°å‡ºåŠ›
logger.info("æ—¥ä»˜ä»˜ããƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã§ã®è¨˜éŒ²ãŒå§‹ã¾ã‚Šã¾ã—ãŸã€‚")
```

---

å¿…è¦ãªã‚‰ã€`loguru`ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã©ã‚’ä½¿ã£ãŸã•ã‚‰ã«ç°¡æ½”ãªæ–¹æ³•ã‚‚ç´¹ä»‹ã§ãã¾ã™ã€‚èˆˆå‘³ã‚ã‚Šã¾ã™ã‹ï¼Ÿ
